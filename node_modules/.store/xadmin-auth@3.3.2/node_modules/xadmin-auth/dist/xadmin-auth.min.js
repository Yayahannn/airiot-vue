!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("lodash"),require("xadmin"),require("xadmin-i18n"),require("react-router-dom"),require("xadmin-form")):"function"==typeof define&&define.amd?define(["exports","react","lodash","xadmin","xadmin-i18n","react-router-dom","xadmin-form"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xadminAuth={},e.React,e._,e.xadmin,e.xadminI18n,e.ReactRouterDOM,e.xadminForm)}(this,(function(e,t,r,n,o,a,i){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=u(t),c=u(r),f=u(n),l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(){throw Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function p(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function h(e,t){return e(t={exports:{}},t.exports),t.exports}var v=p(h((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,t.apply(this,arguments)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}))),y=p(h((function(e){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.default=e.exports,e.exports.__esModule=!0}))),m=p(h((function(e){function t(e,t,r,n,o,a,i){try{var u=e[a](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,o)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(o,a){var i=e.apply(r,n);function u(e){t(i,o,a,u,s,"next",e)}function s(e){t(i,o,a,u,s,"throw",e)}u(void 0)}))}},e.exports.default=e.exports,e.exports.__esModule=!0}))),g=h((function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0}));p(g);var b=h((function(e){e.exports=function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}},e.exports.default=e.exports,e.exports.__esModule=!0}));p(b);var _=h((function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);t>r;r++)n[r]=e[r];return n},e.exports.default=e.exports,e.exports.__esModule=!0}));p(_);var w=h((function(e){e.exports=function(e,t){if(e){if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}));p(w);var x=h((function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));p(x);var S=p(h((function(e){e.exports=function(e,t){return g(e)||b(e,t)||w(e,t)||x()},e.exports.default=e.exports,e.exports.__esModule=!0}))),I=h((function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o=Object.create((t&&t.prototype instanceof l?t:l).prototype),a=new S(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return O()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=_(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=c(e,t,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(e,r,a),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var f={};function l(){}function d(){}function p(){}var h={};h[o]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(I([])));y&&y!==t&&r.call(y,o)&&(h=y);var m=p.prototype=l.prototype=Object.create(h);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var n;this._invoke=function(o,a){function i(){return new t((function(n,i){!function n(o,a,i,u){var s=c(e[o],e,a);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(l).then((function(e){f.value=e,i(f)}),(function(e){return n("throw",e,i,u)}))}u(s.arg)}(o,a,n,i)}))}return n=n?n.then(i,i):i()}}function _(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function I(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:O}}function O(){return{value:void 0,done:!0}}return d.prototype=m.constructor=p,p.constructor=d,d.displayName=u(p,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,u(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},g(b.prototype),b.prototype[a]=function(){return this},e.AsyncIterator=b,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new b(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},g(m),u(m,i,"Generator"),m[o]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=I,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(this.prev>=a.tryLoc){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(a.catchLoc>this.prev)return n(a.catchLoc,!0);if(a.finallyLoc>this.prev)return n(a.finallyLoc)}else if(u){if(a.catchLoc>this.prev)return n(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(a.finallyLoc>this.prev)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(this.prev>=o.tryLoc&&r.call(o,"finallyLoc")&&o.finallyLoc>this.prev){var a=o;break}}!a||"break"!==e&&"continue"!==e||a.tryLoc>t||t>a.finallyLoc||(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}})),O=h((function(e,t){
/*!
    localForage -- Offline Storage, Improved
    Version 1.9.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
e.exports=function e(t,r,n){function o(i,u){if(!r[i]){if(!t[i]){if(!u&&d)return d();if(a)return a(i,!0);var s=Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var c=r[i]={exports:{}};t[i][0].call(c.exports,(function(e){var r=t[i][1][e];return o(r||e)}),c,c.exports,e,t,r,n)}return r[i].exports}for(var a=d,i=0;n.length>i;i++)o(n[i]);return o}({1:[function(e,t,r){!function(e){var r,n,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,i=new o(f),u=e.document.createTextNode("");i.observe(u,{characterData:!0}),r=function(){u.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){f(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(f,0)};else{var s=new e.MessageChannel;s.port1.onmessage=f,r=function(){s.port2.postMessage(0)}}var c=[];function f(){var e,t;n=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}n=!1}t.exports=function(e){1!==c.push(e)||n||r()}}(void 0!==l?l:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){var n=e(1);function o(){}var a={},i=["REJECTED"],u=["FULFILLED"],s=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,e!==o&&p(this,e)}function f(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function l(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return a.reject(e,t)}n===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,n)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var r=!1;function n(t){r||(r=!0,a.reject(e,t))}function o(t){r||(r=!0,a.resolve(e,t))}var i=h((function(){t(o,n)}));"error"===i.status&&n(i.value)}function h(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===u||"function"!=typeof t&&this.state===i)return this;var r=new this.constructor(o);return this.state!==s?l(r,this.state===u?e:t,this.outcome):this.queue.push(new f(r,e,t)),r},f.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},f.prototype.otherCallFulfilled=function(e){l(this.promise,this.onFulfilled,e)},f.prototype.callRejected=function(e){a.reject(this.promise,e)},f.prototype.otherCallRejected=function(e){l(this.promise,this.onRejected,e)},a.resolve=function(e,t){var r=h(d,t);if("error"===r.status)return a.reject(e,r.value);var n=r.value;if(n)p(e,n);else{e.state=u,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},a.reject=function(e,t){e.state=i,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:a.resolve(new this(o),e)},c.reject=function(e){var t=new this(o);return a.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=Array(r),u=0,s=-1,c=new this(o);++s<r;)f(e[s],s);return c;function f(e,o){t.resolve(e).then((function(e){i[o]=e,++u!==r||n||(n=!0,a.resolve(c,i))}),(function(e){n||(n=!0,a.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=-1,u=new this(o);++i<r;)t.resolve(e[i]).then((function(e){n||(n=!0,a.resolve(u,e))}),(function(e){n||(n=!0,a.reject(u,e))}));return u}},{1:1}],3:[function(e,t,r){!function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}(void 0!==l?l:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function a(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;e.length>n;n+=1)r.append(e[n]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var i=Promise;function u(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function s(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e+=""),e}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l=void 0,d={},p=Object.prototype.toString;function h(e){return"boolean"==typeof l?i.resolve(l):function(e){return new i((function(t){var r=e.transaction("local-forage-detect-blob-support","readwrite"),n=a([""]);r.objectStore("local-forage-detect-blob-support").put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return l=e}))}function v(e){var t=d[e.name],r={};r.promise=new i((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady=t.dbReady?t.dbReady.then((function(){return r.promise})):r.promise}function y(e){var t=d[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function m(e,t){var r=d[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function g(e,t){return new i((function(r,n){if(d[e.name]=d[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);v(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var i=o.open.apply(o,a);t&&(i.onupgradeneeded=function(t){var r=i.result;try{r.createObjectStore(e.storeName),t.oldVersion>1||r.createObjectStore("local-forage-detect-blob-support")}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),n(i.error)},i.onsuccess=function(){r(i.result),y(e)}}))}function b(e){return g(e,!1)}function _(e){return g(e,!0)}function w(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version>e.db.version;if(e.db.version>e.version&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),n||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function x(e){return a([function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;t>o;o++)n[o]=e.charCodeAt(o);return r}(atob(e.data))],{type:e.type})}function S(e){return e&&e.__local_forage_encoded_blob}function I(e){var t=this,r=t._initReady().then((function(){var e=d[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return s(r,e,e),r}function O(e,t,r,n){void 0===n&&(n=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(o){if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return i.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.db.version>=e.version)return e.db&&(e.version=e.db.version+1),_(e)})).then((function(){return function(e){v(e);for(var t=d[e.name],r=t.forages,n=0;r.length>n;n++){var o=r[n];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,b(e).then((function(t){return e.db=t,w(e)?_(e):t})).then((function(n){e.db=t.db=n;for(var o=0;r.length>o;o++)r[o]._dbInfo.db=n})).catch((function(t){throw m(e,t),t}))}(e).then((function(){O(e,t,r,n-1)}))})).catch(r);r(o)}}var E={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var o=d[r.name];o||(d[r.name]=o={forages:[],db:null,dbReady:null,deferredOperations:[]}),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=I);var a=[];function u(){return i.resolve()}for(var s=0;o.forages.length>s;s++){var c=o.forages[s];c!==t&&a.push(c._initReady().catch(u))}var f=o.forages.slice(0);return i.all(a).then((function(){return r.db=o.db,b(r)})).then((function(e){return r.db=e,w(r,t._defaultConfig.version)?_(r):e})).then((function(e){r.db=o.db=e,t._dbInfo=r;for(var n=0;f.length>n;n++){var a=f[n];a!==t&&(a._dbInfo.db=r.db,a._dbInfo.version=r.version)}}))},_support:function(){try{if(!o||!o.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==(""+fetch).indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){O(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).openCursor(),u=1;i.onsuccess=function(){var r=i.result;if(r){var n=r.value;S(n)&&(n=x(n));var o=e(n,r.key,u++);void 0!==o?t(o):r.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,t),n},getItem:function(e,t){var r=this;e=c(e);var n=new i((function(t,n){r.ready().then((function(){O(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),S(e)&&(e=x(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,t),n},setItem:function(e,t,r){var n=this;e=c(e);var o=new i((function(r,o){var a;n.ready().then((function(){return a=n._dbInfo,"[object Blob]"===p.call(t)?h(a.db).then((function(e){return e?t:(r=t,new i((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)})));var r})):t})).then((function(t){O(n._dbInfo,"readwrite",(function(a,i){if(a)return o(a);try{var u=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var s=u.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),r(t)},i.onabort=i.onerror=function(){o(s.error?s.error:s.transaction.error)}}catch(e){o(e)}}))})).catch(o)}));return u(o,r),o},removeItem:function(e,t){var r=this;e=c(e);var n=new i((function(t,n){r.ready().then((function(){O(r._dbInfo,"readwrite",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).delete(e);a.oncomplete=function(){t()},a.onerror=function(){n(i.error)},a.onabort=function(){n(i.error?i.error:i.transaction.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,t),n},clear:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){O(t._dbInfo,"readwrite",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){r(a.error?a.error:a.transaction.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,e),r},length:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){O(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).count();a.onsuccess=function(){e(a.result)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,e),r},key:function(e,t){var r=this,n=new i((function(t,n){0>e?t(null):r.ready().then((function(){O(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName),u=!1,s=i.openKeyCursor();s.onsuccess=function(){var r=s.result;r?0===e||u?t(r.key):(u=!0,r.advance(e)):t(null)},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,t),n},keys:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){O(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];a.onsuccess=function(){var t=a.result;t?(i.push(t.key),t.continue()):e(i)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,e),r},dropInstance:function(e,t){t=f.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,a=this;if(e.name){var s=e.name===r.name&&a._dbInfo.db,c=s?i.resolve(a._dbInfo.db):b(e).then((function(t){var r=d[e.name],n=r.forages;r.db=t;for(var o=0;n.length>o;o++)n[o]._dbInfo.db=t;return t}));n=c.then(e.storeName?function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;v(e);var n=d[e.name],a=n.forages;t.close();for(var u=0;a.length>u;u++){var s=a[u];s._dbInfo.db=null,s._dbInfo.version=r}return new i((function(t,n){var a=o.open(e.name,r);a.onerror=function(e){a.result.close(),n(e)},a.onupgradeneeded=function(){a.result.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;a.length>t;t++){var r=a[t];r._dbInfo.db=e,y(r._dbInfo)}})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}}:function(t){v(e);var r=d[e.name],n=r.forages;t.close();for(var a=0;n.length>a;a++)n[a]._dbInfo.db=null;return new i((function(t,r){var n=o.deleteDatabase(e.name);n.onerror=n.onblocked=function(e){var t=n.result;t&&t.close(),r(e)},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;n.length>t;t++)y(n[t]._dbInfo)})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))})}else n=i.reject("Invalid arguments");return u(n,t),n}},j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=/^~~local_forage_type~([^~]+)~/,k=Object.prototype.toString;function A(e){var t,r,n,o,a,i=.75*e.length,u=e.length,s=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),f=new Uint8Array(c);for(t=0;u>t;t+=4)r=j.indexOf(e[t]),n=j.indexOf(e[t+1]),o=j.indexOf(e[t+2]),a=j.indexOf(e[t+3]),f[s++]=r<<2|n>>4,f[s++]=(15&n)<<4|o>>2,f[s++]=(3&o)<<6|63&a;return c}function P(e){var t,r=new Uint8Array(e),n="";for(t=0;r.length>t;t+=3)n+=j[r[t]>>2],n+=j[(3&r[t])<<4|r[t+1]>>4],n+=j[(15&r[t+1])<<2|r[t+2]>>6],n+=j[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var D={serialize:function(e,t){var r="";if(e&&(r=k.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===k.call(e.buffer))){var n,o="__lfsc__:";e instanceof ArrayBuffer?(n=e,o+="arbf"):(n=e.buffer,"[object Int8Array]"===r?o+="si08":"[object Uint8Array]"===r?o+="ui08":"[object Uint8ClampedArray]"===r?o+="uic8":"[object Int16Array]"===r?o+="si16":"[object Uint16Array]"===r?o+="ur16":"[object Int32Array]"===r?o+="si32":"[object Uint32Array]"===r?o+="ui32":"[object Float32Array]"===r?o+="fl32":"[object Float64Array]"===r?o+="fl64":t(Error("Failed to get type for BinaryArray"))),t(o+P(n))}else if("[object Blob]"===r){var a=new FileReader;a.onload=function(){var r="~~local_forage_type~"+e.type+"~"+P(this.result);t("__lfsc__:blob"+r)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,9))return JSON.parse(e);var t,r=e.substring(13),n=e.substring(9,13);if("blob"===n&&N.test(r)){var o=r.match(N);t=o[1],r=r.substring(o[0].length)}var i=A(r);switch(n){case"arbf":return i;case"blob":return a([i],{type:t});case"si08":return new Int8Array(i);case"ui08":return new Uint8Array(i);case"uic8":return new Uint8ClampedArray(i);case"si16":return new Int16Array(i);case"ur16":return new Uint16Array(i);case"si32":return new Int32Array(i);case"ui32":return new Uint32Array(i);case"fl32":return new Float32Array(i);case"fl64":return new Float64Array(i);default:throw Error("Unkown type: "+n)}},stringToBuffer:A,bufferToString:P};function R(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function L(e,t,r,n,o,a){e.executeSql(r,n,o,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,u){u.rows.length?a(e,i):R(e,t,(function(){e.executeSql(r,n,o,a)}),a)}),a):a(e,i)}),a)}function C(e,t,r,n){var o=this;e=c(e);var a=new i((function(a,i){o.ready().then((function(){void 0===t&&(t=null);var u=t,s=o._dbInfo;s.serializer.serialize(t,(function(t,c){c?i(c):s.db.transaction((function(r){L(r,s,"INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){a(u)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void a(C.call(o,e,u,r,n-1));i(t)}}))}))})).catch(i)}));return u(a,r),a}function F(e){return new i((function(t,r){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,n){for(var o=[],a=0;n.rows.length>a;a++)o.push(n.rows.item(a).name);t({db:e,storeNames:o})}),(function(e,t){r(t)}))}),(function(e){r(e)}))}))}var T={_driver:"webSQLStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?""+e[n]:e[n];var o=new i((function(e,n){try{r.db=openDatabase(r.name,r.version+"",r.description,r.size)}catch(e){return n(e)}r.db.transaction((function(o){R(o,r,(function(){t._dbInfo=r,e()}),(function(e,t){n(t)}))}),n)}));return r.serializer=D,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){L(r,o,"SELECT * FROM "+o.storeName,[],(function(r,n){for(var a=n.rows,i=a.length,u=0;i>u;u++){var s=a.item(u),c=s.value;if(c&&(c=o.serializer.deserialize(c)),void 0!==(c=e(c,s.key,u+1)))return void t(c)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,t),n},getItem:function(e,t){var r=this;e=c(e);var n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){L(r,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=o.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,t),n},setItem:function(e,t,r){return C.call(this,e,t,r,1)},removeItem:function(e,t){var r=this;e=c(e);var n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){L(r,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,t),n},clear:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){L(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,e),r},length:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){L(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,r){var n=r.rows.item(0).c;e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,e),r},key:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){L(r,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,t),n},keys:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){L(t,n,"SELECT key FROM "+n.storeName,[],(function(t,r){for(var n=[],o=0;r.rows.length>o;o++)n.push(r.rows.item(o).key);e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,e),r},dropInstance:function(e,t){t=f.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;return u(n=e.name?new i((function(t){var n;n=e.name===r.name?o._dbInfo.db:openDatabase(e.name,"","",0),t(e.storeName?{db:n,storeNames:[e.storeName]}:F(n))})).then((function(e){return new i((function(t,r){e.db.transaction((function(n){function o(e){return new i((function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}for(var a=[],u=0,s=e.storeNames.length;s>u;u++)a.push(o(e.storeNames[u]));i.all(a).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):i.reject("Invalid arguments"),t),n}};function M(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function B(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var z={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=M(e,this._defaultConfig),B()?(this._dbInfo=t,t.serializer=D,i.resolve()):i.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=r.ready().then((function(){for(var t=r._dbInfo,n=t.keyPrefix,o=n.length,a=localStorage.length,i=1,u=0;a>u;u++){var s=localStorage.key(u);if(0===s.indexOf(n)){var c=localStorage.getItem(s);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,s.substring(o),i++)))return c}}}));return u(n,t),n},getItem:function(e,t){var r=this;e=c(e);var n=r.ready().then((function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return u(n,t),n},setItem:function(e,t,r){var n=this;e=c(e);var o=n.ready().then((function(){void 0===t&&(t=null);var r=t;return new i((function(o,a){var i=n._dbInfo;i.serializer.serialize(t,(function(t,n){if(n)a(n);else try{localStorage.setItem(i.keyPrefix+e,t),o(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||a(e),a(e)}}))}))}));return u(o,r),o},removeItem:function(e,t){var r=this;e=c(e);var n=r.ready().then((function(){localStorage.removeItem(r._dbInfo.keyPrefix+e)}));return u(n,t),n},clear:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return u(r,e),r},length:function(e){var t=this.keys().then((function(e){return e.length}));return u(t,e),t},key:function(e,t){var r=this,n=r.ready().then((function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return u(n,t),n},keys:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,n=[],o=0;r>o;o++){var a=localStorage.key(o);0===a.indexOf(e.keyPrefix)&&n.push(a.substring(e.keyPrefix.length))}return n}));return u(r,e),r},dropInstance:function(e,t){if(t=f.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,o=this;return u(n=e.name?new i((function(t){t(e.storeName?M(e,o._defaultConfig):e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}})):i.reject("Invalid arguments"),t),n}},U=function(e,t){for(var r,n,o=e.length,a=0;o>a;){if((r=e[a])===(n=t)||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return!0;a++}return!1},q=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},W={},J={},G={INDEXEDDB:E,WEBSQL:T,LOCALSTORAGE:z},V=[G.INDEXEDDB._driver,G.WEBSQL._driver,G.LOCALSTORAGE._driver],H=["dropInstance"],K=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(H),Q={description:"",driver:V.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function X(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function Y(){for(var e=1;arguments.length>e;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(arguments[0][r]=q(t[r])?t[r].slice():t[r])}return arguments[0]}var $=new(function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),G)if(G.hasOwnProperty(r)){var n=G[r],o=n._driver;this[r]=o,W[o]||this.defineDriver(n)}this._defaultConfig=Y({},Q),this._config=Y({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new i((function(t,r){try{var n=e._driver,o=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(o);for(var a=K.concat("_initStorage"),s=0,c=a.length;c>s;s++){var f=a[s];if((!U(H,f)||e[f])&&"function"!=typeof e[f])return void r(o)}!function(){for(var t=function(e){return function(){var t=Error("Method "+e+" is not implemented by the current driver"),r=i.reject(t);return u(r,arguments[arguments.length-1]),r}},r=0,n=H.length;n>r;r++){var o=H[r];e[o]||(e[o]=t(o))}}();var l=function(r){W[n]&&console.info("Redefining LocalForage driver: "+n),W[n]=e,J[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(l,r):l(!!e._support):l(!0)}catch(e){r(e)}}));return s(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=W[e]?i.resolve(W[e]):i.reject(Error("Driver not found."));return s(n,t,r),n},e.prototype.getSerializer=function(e){var t=i.resolve(D);return s(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return s(r,e,e),r},e.prototype.setDriver=function(e,t,r){var n=this;q(e)||(e=[e]);var o=this._getSupportedDrivers(e);function a(){n._config.driver=n.driver()}function u(e){return n._extend(e),a(),n._ready=n._initStorage(n._config),n._ready}var c=null!==this._driverSet?this._driverSet.catch((function(){return i.resolve()})):i.resolve();return this._driverSet=c.then((function(){var e=o[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,a(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){var t=0;return function r(){for(;e.length>t;){var o=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(o).then(u).catch(r)}return a(),n._driverSet=i.reject(Error("No available storage method found.")),n._driverSet}()}}(o)}))})).catch((function(){return a(),n._driverSet=i.reject(Error("No available storage method found.")),n._driverSet})),s(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!J[e]},e.prototype._extend=function(e){Y(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;n>r;r++){var o=e[r];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=K.length;t>e;e++)X(this,K[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=$},{3:3}]},{},[4])(4)})),E=h((function(e,t){e.exports=function(){function e(){for(var e=0,t={};arguments.length>e;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function r(n){function o(){}function a(t,r,a){if("undefined"!=typeof document){"number"==typeof(a=e({path:"/"},o.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var i=JSON.stringify(r);/^[\{\[]/.test(i)&&(r=i)}catch(e){}r=n.write?n.write(r,t):encodeURIComponent(r+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(t+"").replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var s in a)a[s]&&(u+="; "+s,!0!==a[s]&&(u+="="+a[s].split(";")[0]));return document.cookie=t+"="+r+u}}function i(e,r){if("undefined"!=typeof document){for(var o={},a=document.cookie?document.cookie.split("; "):[],i=0;a.length>i;i++){var u=a[i].split("="),s=u.slice(1).join("=");r||'"'!==s.charAt(0)||(s=s.slice(1,-1));try{var c=t(u[0]);if(s=(n.read||n)(s,c)||t(s),r)try{s=JSON.parse(s)}catch(e){}if(o[c]=s,e===c)break}catch(e){}}return e?o[e]:o}}return o.set=a,o.get=function(e){return i(e,!1)},o.getJSON=function(e){return i(e,!0)},o.remove=function(t,r){a(t,"",e(r,{expires:-1}))},o.defaults={},o.withConverter=r,o}((function(){}))}()})),j=h((function(e){e.exports=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;a.length>n;n++)0>t.indexOf(r=a[n])&&(o[r]=e[r]);return o},e.exports.default=e.exports,e.exports.__esModule=!0}));p(j);var N=p(h((function(e){e.exports=function(e,t){if(null==e)return{};var r,n,o=j(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;a.length>n;n++)0>t.indexOf(r=a[n])&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o},e.exports.default=e.exports,e.exports.__esModule=!0}))),k=s.default.createContext(null),A=function(e){var t=e.children,r=n.use("auth.context"),o=r.show,a=N(r,["show"]);return o&&s.default.createElement(k.Provider,{value:a},t)};function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R={"auth.user":function(){return s.default.useContext(k)},"auth.context":function(){var e=n.app.load_dict("config").auth,t=s.default.useState(!1),r=S(t,2),o=r[0],a=r[1],i=s.default.useState(null),u=S(i,2),f=u[0],l=u[1],d=function(e){n.app.context.user=e,l(e)};return s.default.useEffect((function(){(function(){var t=m(I.mark((function t(){var r,o,i,u;return I.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,"localforage"!=e.persist_type){t.next=15;break}return t.prev=2,t.next=5,O.getItem("user");case 5:(o=t.sent)&&(r=JSON.parse(o)),t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(2),t.next=13,O.removeItem("user");case 13:t.next=16;break;case 15:"session-storage"==e.persist_type?(i=sessionStorage.getItem("user"))&&(r=JSON.parse(i)):"cookie"==e.persist_type&&(r=E.getJSON("user"));case 16:if(c.default.isEmpty(r)){t.next=27;break}return d(r),t.prev=18,t.next=21,n.api({name:"auth"}).get("user");case 21:c.default.isEmpty(u=t.sent)||d(D(D({},r),u)),t.next=27;break;case 25:t.prev=25,t.t1=t.catch(18);case 27:setTimeout((function(){return a(!0)}),0);case 28:case"end":return t.stop()}}),t,null,[[2,9],[18,25]])})));return function(){return t.apply(this,arguments)}})()()}),[]),s.default.useEffect((function(){(function(){var t=m(I.mark((function t(){return I.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("localforage"!=e.persist_type){t.next=10;break}if(!f){t.next=6;break}return t.next=4,O.setItem("user",JSON.stringify(f));case 4:t.next=8;break;case 6:return t.next=8,O.removeItem("user");case 8:t.next=11;break;case 10:"session-storage"==e.persist_type?f?sessionStorage.setItem("user",JSON.stringify(f)):sessionStorage.removeItem("user"):"cookie"==e.persist_type&&(f?E.set("user",f,e.userinfo_timeout?{expires:e.userinfo_timeout}:{}):E.remove("user"));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[f]),{show:o,user:f,setUser:d}},"auth.login":function(){var e=n.use("location"),t=n.use("query"),r=n.use("navigate"),a=n.use("message"),i=n.use("auth.user").setUser,u=function(){var t=m(I.mark((function t(a){var u,s,f,l;return I.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.api({name:"auth/login"}).save(a);case 3:if(i(c.default.omit(f=t.sent,"password")),null!=f.name||null!=f.username){t.next=15;break}return t.prev=6,t.next=9,n.api({name:"auth"}).get("user");case 9:l=t.sent,i(D(D({},f),l)),t.next=15;break;case 13:t.prev=13,t.t0=t.catch(6);case 15:r((null===(u=e.state)||void 0===u||null===(s=u.from)||void 0===s?void 0:s.pathname)||"/app/",{replace:!0}),t.next=22;break;case 18:throw t.prev=18,t.t1=t.catch(0),console.log(t.t1),t.t1.json&&null==t.t1.json.non_field_errors?t.t1.json:{password:o._t("Incorrect username or password")};case 22:case"end":return t.stop()}}),t,null,[[0,18],[6,13]])})));return function(e){return t.apply(this,arguments)}}();return s.default.useEffect((function(){"success"==t.verifyEmail&&a&&a.success(o._t("Verify email success, please login"))}),[]),{onSignIn:u}},"auth.logout":function(){var e=n.use("auth.user").setUser,t=n.use("message");return{onLogout:s.default.useCallback(m(I.mark((function r(){return I.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,n.api({name:"auth/logout"}).save({});case 3:t&&t.success(o._t("Successfully logged out")),e(null),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),n.app.error(r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,7]])}))),[])}},"auth.sign_up":function(){var e=n.use("navigate"),t=n.use("message");return{onSuccess:function(r){r.key?n.api({name:"auth/registration/verify-email"}).save(D({language:"zh_CN"},r)).then((function(){t&&t.success(o._t("Send verify code to your email, please check"))})):r.detail&&t&&t.success(r.detail),e("/login")}}},"auth.forget_password":function(){var e=n.use("navigate");return{onSuccess:function(t){e("/login")}}},"auth.change_password":function(){var e=n.use("navigate"),t=n.use("message");return{onChange:function(){var r=m(I.mark((function r(a){return I.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,n.api({name:"user/password"}).save(a);case 3:t&&t.success(o._t("Change password success")),e("/app/"),r.next=10;break;case 7:throw r.prev=7,r.t0=r.catch(0),Error({old_password:o._t("Incorrect old password")});case 10:case"end":return r.stop()}}),r,null,[[0,7]])})));return function(e){return r.apply(this,arguments)}}()}},"auth.reset_password":function(){var e=n.use("navigate");return{onSuccess:function(t){e("/login")}}}};function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;a.length>n;n++)0>t.indexOf(r=a[n])&&(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;a.length>n;n++)0>t.indexOf(r=a[n])&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var T=function e(t){if("string"==typeof t)return f.default.get("components")[t];var r=t.is,n=F(t,["is"]),o=e(r);return o?s.default.createElement(o,n):s.default.createElement("div",null,"Component ",r," not found.")};T.lazy=function(e){return function(t){return T(function(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({is:e},t))}},T.lazy("Main"),T.lazy("App"),T.lazy("Dashboard");var M=T.lazy("Page");T.lazy("Icon"),T.lazy("Loading"),T.lazy("Dropdown");var B=T.lazy("Menu");B.SubMenu=T.lazy("Menu.SubMenu"),B.Item=T.lazy("Menu.Item"),T.lazy("Badge"),T.lazy("Card"),T.lazy("Modal"),T.lazy("Button"),T.lazy("Popover"),T.lazy("Tooltip"),T.lazy("Table"),T.lazy("Tabs").Item=T.lazy("Tabs.Item"),T.lazy("Empty"),T.lazy("List").Item=T.lazy("List.Item"),T.lazy("Alert"),T.lazy("Input").Static=T.lazy("Input.Static"),T.lazy("Check"),T.lazy("Select");var z=h((function(e){e.exports=function(e){if(Array.isArray(e))return _(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));p(z);var U=h((function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));p(U);var q=h((function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));p(q);var W=p(h((function(e){e.exports=function(e){return z(e)||U(e)||w(e)||q()},e.exports.default=e.exports,e.exports.__esModule=!0})));function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V=function(){return{type:"object",name:"auth_permission",resource:"auth/permission",title:o._t("Permission"),icon:"key",properties:{name:{title:o._t("Name"),type:"string"},description:{title:o._t("Description"),type:"string"}},searchFields:["name"],ui:{showMenu:!1}}},H=function(){return{type:"object",name:"auth_role",resource:"auth/role",title:o._t("Role"),icon:"group",properties:{name:{title:o._t("Name"),type:"string"},permissions:{title:o._t("Permission"),type:"array",items:V()}},searchFields:["name"],ui:{showMenu:!1}}},K=function(e){var t=n.use("auth.login").onSignIn;return s.default.createElement(i.SchemaForm,{schema:{type:"object",name:"user_sign_in",resource:"auth/login",title:o._t("Sign In"),properties:G({username:{title:o._t("Username"),type:"string"},password:{title:o._t("Password"),type:"string"}},n.config("auth.login.captcha")?{code:{title:o._t("Captcha Code"),type:"string",fieldType:"captcha"}}:{}),required:["username","password"].concat(W(n.config("auth.login.captcha")?["code"]:[])),form:["username",{key:"password",attrs:{type:"password"}}].concat(W(n.config("auth.login.captcha")?[{key:"code",captcha_url:"/"+n.config("auth.login.captcha")}]:[]))},onSubmit:t,component:T("Auth.Signin")||T("Auth.Form")})},Q=function(e){var t=n.use("auth.sign_up").onSuccess;return s.default.createElement(i.SchemaForm,{schema:{type:"object",name:"user_sign_up",resource:"auth/registration",title:o._t("Sign Up"),properties:G({username:{title:o._t("User Name"),type:"string"},email:{title:o._t("Email"),type:"string"},password1:{title:o._t("Password"),type:"string",maxLength:12,minLength:6},password2:{title:o._t("Repeat Password"),type:"string",maxLength:12,minLength:6,constant:{$data:"1/password1",constantName:o._t("Password")}}},n.config("auth.registration.captcha")?{code:{title:o._t("Captcha Code"),type:"string",fieldType:"captcha"}}:{}),permission:{add:!0},required:["username","email","password1","password2"].concat(W(n.config("auth.registration.captcha")?["code"]:[])),form:["username","email",{key:"password1",attrs:{type:"password"}},{key:"password2",attrs:{type:"password"}}].concat(W(n.config("auth.registration.captcha")?[{key:"code",captcha_url:"/"+n.config("auth.registration.captcha")}]:[]))},onSubmit:t,component:T("Auth.Signup")||T("Auth.Form")})},X=function(e){var t=n.use("auth.forget_password").onSuccess;return s.default.createElement(i.SchemaForm,{schema:{type:"object",name:"user_forgot_password",resource:"auth/password/reset",title:o._t("Forgot password"),properties:{email:{title:o._t("Register Email"),type:"string",format:"email"}},required:["email"],form:["email"]},successMessage:o._t("Send reset password email success"),onSubmitSuccess:t,component:T("Auth.ForgetPassword")||T("Auth.Form")})},Y=function(e){var t=n.use("auth.reset_password").onSuccess,r=n.use("query");return s.default.createElement(i.SchemaForm,{schema:{type:"object",name:"user_reset_password",resource:"auth/password/reset/confirm",title:o._t("Reset Password"),properties:{new_password1:{title:o._t("New Password"),type:"string",maxLength:12,minLength:6},new_password2:{title:o._t("Repeat Password"),type:"string",maxLength:12,minLength:6,constant:{$data:"1/new_password1",constantName:o._t("New Password")}},token:{type:"string"},uid:{type:"string"}},form:[{key:"new_password1",attrs:{type:"password"}},{key:"new_password2",attrs:{type:"password"}}]},initialValues:r,successMessage:o._t("Reset password success"),onSubmitSuccess:t,component:T("Auth.ResetPassword")||T("Auth.Form")})},$=function(e){var t=n.use("auth.change_password").onChange;return s.default.createElement(M,{title:o._t("Change Password")},s.default.createElement(i.SchemaForm,{schema:{type:"object",name:"user_change_password",resource:"user/password",title:o._t("Change Password"),properties:{old_password:{title:o._t("Old Password"),type:"string",maxLength:12,minLength:6},new_password:{title:o._t("New Password"),type:"string",maxLength:12,minLength:6},new_password2:{title:o._t("Repeat Password"),type:"string",maxLength:12,minLength:6,const:{$data:"1/new_password",constantName:o._t("New Password")}}},required:["old_password","new_password","new_password2"],form:[{key:"old_password",attrs:{type:"password"}},{key:"new_password",attrs:{type:"password"}},{key:"new_password2",attrs:{type:"password"}}]},onSubmit:t,submitText:o._t("Change Password"),component:T("Auth.ChangePassword")||T("Auth.Form")}))},Z=function(e){var t=e.children,r=n.use("location");return n.use("auth.user").user?t:s.default.createElement(a.Navigate,{to:"/login",state:{from:r},replace:!0})},ee={name:"xadmin.auth",config:{auth:{can_reset_password:!0,can_change_password:!0,can_signup:!0,can_signin:!0,persist_type:"localforage"}},blocks:{"top.right":function(e){return s.default.createElement(T,v({is:"Auth.UserMenu",key:"auth.user"},e))}},components:{App:function(e){return s.default.createElement(Z,null,s.default.createElement(T,v({is:"BaseApp"},e)))}},root_component:function(e){return function(e){return s.default.createElement(A,null,e)}},routers:function(e){var t=e.load_dict("config").auth,r=[];return t.can_signin&&r.push({path:"login",component:K}),t.can_signup&&r.push({path:"signup",component:Q}),t.can_reset_password&&(r.push({path:"forget_password",component:X}),r.push({path:"password_reset_confirm",component:Y})),{"/":r,"/app/":{path:"change_password",component:$}}},schema_converter:function(e,t){return"string"===t.type&&"captcha"==t.fieldType&&(e.type="captcha"),e},models:function(){return{auth_user:{type:"object",name:"auth_user",resource:"user",title:o._t("User"),icon:"user",properties:{username:{title:o._t("Name"),type:"string"},email:{title:o._t("Email"),type:"string"},emailVerified:{type:"boolean",title:o._t("Email Verified")},is_superuser:{type:"boolean",title:o._t("Is SuperUser")},date_joined:{type:"string",format:"date",title:o._t("Date Joined")},permissions:{title:o._t("Permission"),type:"array",items:V()},roles:{title:o._t("Role"),type:"array",items:H()}},searchFields:["username","email"],filters:{nav:["emailVerified","is_superuser","date_joined"]},listFields:["username","email","is_superuser","date_joined"],form:["username","email","is_superuser"],permission:{view:!0,add:!0,edit:!0,delete:!0},ui:{show_menu:!1}},auth_permission:V(),auth_role:H()}},hooks:R};e.HasPermission=function(e){var t=e.permission,r=e.FailureComponent,o=void 0===r?"NoPermission":r,a=e.children,i=N(e,["permission","FailureComponent","children"]);return function(e){return!(!e||!e.isSuper)||!(!e||!e.permissions)&&(c.default.isArray(t)?!c.default.some(t,(function(t){return-1==e.permissions.indexOf(t)})):c.default.isFunction(t)?t(e):e.permissions.indexOf(t)>-1)}(n.use("auth.user").user)?Object.keys(i).length>0?s.default.cloneElement(a,i):a:s.default.isValidElement(o)?o:c.default.isFunction(o)?s.default.createElement(o,null):o},e.IsAuthenticated=Z,e.IsSuperUser=function(e){var t=e.children,r=n.use("auth.user").user;return null!==r&&r.isSuper?t:(f.default.go("/app"),null)},e.ShowAuthenticated=function(e){var t=e.children;return n.use("auth.user").user?t:null},e.default=ee,e.perm=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=f.default.context.store;return(r=o.getState().user)&&r.isSuper||r&&r.permissions&&(c.default.isArray(e)?!c.default.some(e,(function(e){return-1==r.permissions.indexOf(e)})):c.default.isFunction(e)?e(r):r.permissions.indexOf(e)>-1)?t:n},Object.defineProperty(e,"__esModule",{value:!0})}));
